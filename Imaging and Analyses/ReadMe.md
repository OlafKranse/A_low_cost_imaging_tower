Tested on; Windows 11 using Powershell 7, python 3.10.1 and imageJ 1.53o

### Intro
In order to automatically count and extract features from nematodes scripts and images need to be adjusted and normalised. The parameters that need changing are dependent on the colour spectrum of the image. To prevent having to set the treshold for every image, a python script is used to normalise the colour spectrum between all images. The treshold is then set for this one reference image, and the script to extract features is run using the interactive interpreter in imageJ.

### Adjusting the script
There is one command in the imageJ script that needs to be changed. The colour treshold needs to be set to the right values for the one reference image. A tool that can help you turn your treshold into a command is the recorder in imageJ (Plugins > Macros... > Record). The colour treshold for an image can be set trough the imageJ GUI (Image > Adjust... > Color treshold). Adjust the treshold sliders until happy with the parameters. Click the Macro button in the colour treshold tool window with the Recorder open. In the recorder a line should appear similar to the one below. Replace the line in the script with your version of the line. 

Example of Macro line:

	// Color Thresholder 1.53k
	// Autogenerated macro, single images only!
	min=newArray(3);
	max=newArray(3);
	filter=newArray(3);
	a=getTitle();
	run("HSB Stack");
	run("Convert Stack to Images");
	selectWindow("Hue");
	rename("0");
	selectWindow("Saturation");
	rename("1");
	selectWindow("Brightness");
	rename("2");
	min[0]=110;
	max[0]=195;
	filter[0]="pass";
	min[1]=0;
	max[1]=255;
	filter[1]="pass";
	min[2]=70;
	max[2]=255;
	filter[2]="pass";
	for (i=0;i<3;i++){
	  selectWindow(""+i);
	  setThreshold(min[i], max[i]);
	  run("Convert to Mask");
	  if (filter[i]=="stop")  run("Invert");
	}
	imageCalculator("AND create", "0","1");
	imageCalculator("AND create", "Result of 0","2");
	for (i=0;i<3;i++){
	  selectWindow(""+i);
	  close();
	}
	selectWindow("Result of 0");
	close();
	selectWindow("Result of Result of 0");
	rename(a);
	// Colour Thresholding-------------
	
### Workflow
1) To automate the analyses we first need to normalise the images colour between all images. Please find further instructions on: A_low_cost_imaging_tower/Imaging and Analyses/Normalise colour/ in this git. 

2) Once normalised the treshold needs to be adjusted using the instructions above. 

3) To automatically count the nematodes the script in its entirety needs to be copied into t einteractive interpreter in imageJ. The script will attempt to extract features from the image that match both the common size, shape and color of the nematode. The script does struggle with edges of plates, the user is therefore asked to input an area of interest, only selecting the inner part of the plate where nematodes can be observed.
 





	
